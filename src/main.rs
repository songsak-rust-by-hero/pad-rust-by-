mod account;
mod error;
mod satang;

use account::Account;
use error::BankError;
use satang::satang_to_baht;

fn main() {
    println!("üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô...");

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö
    if let Err(e) = run_withdraw_tests() {
        eprintln!("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î: {}", e);
    }
}

fn run_withdraw_tests() -> Result<(), BankError> {
    // --- ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô 10,000 ‡∏ö‡∏≤‡∏ó ---
    let mut acc = Account::new("TH-777".to_string(), 10_000_00)?;
    println!(
        "‚úÖ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß: ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô {} ",
        satang_to_baht(acc.balance())
    );

    // --- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 1: ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à) ---
    println!("\n[Test 1] ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô 2,500 ‡∏ö‡∏≤‡∏ó");
    acc.withdraw(2_500_00)?;
    println!("üí∞ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: {} ‡∏ö‡∏≤‡∏ó", satang_to_baht(acc.balance()));

    // --- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 2: ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ (‡∏ï‡πâ‡∏≠‡∏á Error: ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠) ---
    println!("\n[Test 2] ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô 10,000 ‡∏ö‡∏≤‡∏ó (‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏µ‡πÑ‡∏°‡πà‡∏û‡∏≠)");
    if let Err(e) = acc.withdraw(10_000_00) {
        println!("üß° ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: {}", e);
    }

    // --- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 3: ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (‡∏ï‡πâ‡∏≠‡∏á Error: ‡πÄ‡∏Å‡∏¥‡∏ô‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô) ---
    // (‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà 100,000 ‡∏ö‡∏≤‡∏ó ‡πÉ‡∏ô Account::new)
    println!("\n[Test 3] ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô 110,000 ‡∏ö‡∏≤‡∏ó (‡πÄ‡∏Å‡∏¥‡∏ô‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)");
    if let Err(e) = acc.withdraw(110_000_00) {
        println!("üß° ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: {}", e);
    }

    // --- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 4: ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö (‡∏ï‡πâ‡∏≠‡∏á Error: ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö) ---
    println!("\n[Test 4] ‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡∏ñ‡∏≠‡∏ô 100 ‡∏ö‡∏≤‡∏ó");
    acc.set_frozen(true);
    if let Err(e) = acc.withdraw(100_00) {
        println!("üß° ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: {}", e);
    }
    acc.set_frozen(false); // ‡∏õ‡∏•‡∏î‡∏£‡∏∞‡∏á‡∏±‡∏ö

    // --- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 5: ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏¥‡∏î‡∏•‡∏ö (‡∏ï‡πâ‡∏≠‡∏á Error: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á) ---
    println!("\n[Test 5] ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô -500 ‡∏ö‡∏≤‡∏ó");
    if let Err(e) = acc.withdraw(-500_00) {
        println!("üß° ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: {}", e);
    }

    println!(
        "\n‚ú® ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢: {} ‡∏ö‡∏≤‡∏ó",
        satang_to_baht(acc.balance())
    );
    Ok(())
}
